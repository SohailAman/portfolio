/*-----------------------------------------------------------
 * Template Name    : Sohail | Responsive One Page HTML Template
 * Author           : VibeCoder
 * Version          : 1.0.0
 * Created          : 2023
 * File Description : Main js file of the template
 *------------------------------------------------------------
 */

// Function to add or remove classes based on color scheme
function updateColorSchemeClasses() {
  const body = document.body;

  // Check if prefers-color-scheme is dark
  if (
    window.matchMedia &&
    window.matchMedia("(prefers-color-scheme: dark)").matches
  ) {
    body.classList.add("Sohail-dark");
  }
  // If prefers-color-scheme is light or no preference
  else {
    body.classList.remove("Sohail-dark");
    body.classList.add("flat-demo");
  }
}

// Call the function on initial page load
updateColorSchemeClasses();

// Listen for changes in color scheme preference
window
  .matchMedia("(prefers-color-scheme: dark)")
  .addListener(updateColorSchemeClasses);

// repeated variables
var $window = $(window);
var $root = $("html, body");

$(document).ready(function () {
  "use strict";

  themeOption();
  navbarToggler();
  smoothScroll();
  bgBackground();
  colorFull();
  borderColor();
  ColorPallet();
  typedJS();
  postSidebar();
});

// Display the preloader initially
$("#overlayer").fadeIn("slow");

// Simulate an asynchronous data loading operation (replace this with your actual data loading logic)
const loadData = new Promise((resolve) => {
  // ... Your data loading logic goes here ...
  // Simulate loading completion
  resolve();
});

// After data loading is complete, fade out the preloader
loadData.then(() => {
  $("#overlayer").delay(500).fadeOut("slow");
  $(".loader").delay(500).fadeOut("slow");
});

$window.on("load", function () {
  ChangeColor();
  scrollToAnchor();
});

$window.on("scroll", function () {
  returnToTop();
  headerSticky();
  ChangeColor();
  skills();
});

/*-----------------------------------------------------------------------------
                                   FUNCTIONS
-----------------------------------------------------------------------------*/

$(".ancor").click(function (event) {
  event.preventDefault();
  var href = $(this).attr("href");
  var target = $(this).attr("target");
  if (target === "_blank") {
    window.open(href, "_blank");
  } else {
    window.location.href = href;
  }
});

/*-------------------------
        Theme Option
-------------------------*/
function themeOption() {
  "use strict";

  $(".color-scheme li .dark-scheme").click(function () {
    $("body").addClass("Sohail-dark");
    $(".color-scheme li a").removeClass("active");
    $(this).addClass("active");
  });

  $(".color-scheme li .light-scheme").click(function () {
    $("body").removeClass("Sohail-dark");
    $(".color-scheme li a").removeClass("active");
    $(this).addClass("active");
  });

  $(".theme-skin li .flat-skin").click(function () {
    $("body").addClass("flat-demo sohail-light");
    $(".theme-skin li a").removeClass("active");
    $(this).addClass("active");
  });

  $(".theme-skin li .neo-skin").click(function () {
    $("body").removeClass("flat-demo");
    $(".theme-skin li a").removeClass("active");
    $(this).addClass("active");
  });
}

/*--------------------------
       RETURN TO TOP
--------------------------*/
function returnToTop() {
  "use strict";

  var $returnToTop = $(".return-to-top");
  if ($window.scrollTop() > 150) {
    $returnToTop.addClass("show");
  } else {
    $returnToTop.removeClass("show");
  }
  $returnToTop.click(function () {
    $root.stop().animate(
      {
        scrollTop: 0,
      },
      1500
    );
  });
}

/*--------------------------
       NAVBAR TOGGLER
--------------------------*/
function navbarToggler() {
  $(".navbar-toggler").on("click", function () {
    $("header").toggleClass("z-index");
    $("#toggle-menu").toggleClass("collapse");
    $(".post-sidebar-toggle").toggleClass("d-none");
  });
}
/*-------------------------
        SMOOTH SCROLL
-------------------------*/
function smoothScroll() {
  "use strict";

  $(".header .navbar-nav a, .to-contact, .scroll-down a").on(
    "click",
    function (event) {
      var $anchor = $(this);
      $root.stop().animate(
        {
          scrollTop: $($anchor.attr("href")).offset().top - 60,
        },
        1500,
        "easeInOutQuart"
      );
      event.preventDefault();
      $(".navbar-collapse").collapse("hide");
    }
  );
}

/*-------------------------
        SCROLL TO
-------------------------*/

function scrollToAnchor() {
  //getting the anchor link in the URL and deleting the `#`
  var value = window.location.hash.replace("");
  var sectionAnchor = value;
  var section = $(document).find(sectionAnchor);

  if (section.length > 0) {
    $root.stop().animate(
      {
        scrollTop: $(section).offset().top - 60,
      },
      1500,
      "easeInOutQuart"
    );
  }
}

/*-------------------------
        HEADER STICKY
-------------------------*/
function headerSticky() {
  "use strict";

  if ($window.scrollTop() > 10) {
    $("#header").addClass("header-sticky");
  } else {
    $("#header").removeClass("header-sticky");
  }
}

/*-------------------------
        ChangeColor
-------------------------*/
function ChangeColor() {
  "use strict";

  // var top1 = $('#hero').offset().top;
  // var top2 = $('#about').offset().top;

  if ($window.width() > 991 && $window.scrollTop() < 100) {
    $(".special-section").css("color", "#fff");
  } else {
    $(".special-section").css("color", "#1a1a1a");
  }
}

/*-------------------------
        ColorFull Demo
-------------------------*/

function bgBackground() {
  "use strict";

  var list = document.getElementsByClassName("data-background");

  for (var i = 0; i < list.length; i++) {
    var color = list[i].getAttribute("data-color");
    list[i].style.backgroundColor = "" + color + "";
  }
}

function colorFull() {
  var allDivs = document.getElementsByClassName("data-text-color");

  for (var i = 0; i < allDivs.length; ++i) {
    var color = allDivs[i].getAttribute("data-color");
    allDivs[i].style.color = "" + color + "";
  }
}

function borderColor() {
  var allDivs = document.getElementsByClassName("timeline-border");

  for (var i = 0; i < allDivs.length; ++i) {
    var color = allDivs[i].getAttribute("data-color");
    allDivs[i].style.borderLeftColor = "" + color + "";
  }
}

// -------------------------------------------------------------
//   Color Panel
// -------------------------------------------------------------
function ColorPallet() {
  "use strict";

  $("ul.pattern .color1").click(function () {
    return $("#option-color").attr("href", "css/color/green-color.min.css"), !1;
  });
  $("ul.pattern .color2").click(function () {
    return (
      $("#option-color").attr("href", "css/color/yellow-color.min.css"), !1
    );
  });
  $("ul.pattern .color3").click(function () {
    return (
      $("#option-color").attr("href", "css/color/golden-color.min.css"), !1
    );
  });
  $("ul.pattern .color4").click(function () {
    return (
      $("#option-color").attr("href", "css/color/sky-blue-color.min.css"), !1
    );
  });
  $("ul.pattern .color5").click(function () {
    return $("#option-color").attr("href", "css/color/blue-color.min.css"), !1;
  });
  $("ul.pattern .color6").click(function () {
    return (
      $("#option-color").attr("href", "css/color/purple-color.min.css"), !1
    );
  });
  $("ul.pattern .color7").click(function () {
    return (
      $("#option-color").attr("href", "css/color/orange-color.min.css"), !1
    );
  });
  $("ul.pattern .color8").click(function () {
    return $("#option-color").attr("href", "css/color/pink-color.min.css"), !1;
  });
  $("ul.pattern .color9").click(function () {
    return $("#option-color").attr("href", "css/color/red-color.min.css"), !1;
  });
  $("#color-switcher .pallet-button").click(function () {
    return $("#color-switcher .color-pallet").toggleClass("show"), !1;
  });
  $("body").click(function () {
    return $("#color-switcher .color-pallet").removeClass("show"), !1;
  });
}


/*-------------------------
        TYPED JS
-------------------------*/
function typedJS() {
  "use strict";

  if ($(".element").length > 0) {
    var options = {
      strings: $(".element").attr("data-elements").split(","),
      typeSpeed: 100,
      backDelay: 3000,
      backSpeed: 50,
      loop: true,
    };
    var typed = new Typed(".element", options);
  }
}
/*-------------------------
          Skills
-------------------------*/
function skills() {
  "use strict";

  var scroll = $window.scrollTop();
  var skillsDiv = $("#skills");
  if (skillsDiv.length > 0) {
    var winH = $window.height(),
      skillsT = skillsDiv.offset().top;
    if (scroll + winH > skillsT) {
      $(".skillbar").each(function () {
        $(this)
          .find(".skillbar-bar")
          .animate(
            {
              width: $(this).attr("data-percent"),
            },
            2500
          );
      });
    }
  }
}

// scroll
$(window).scroll(function () {
  var scroll = $window.scrollTop();
  var shape = $(".main-menu");
  var shapeOffset = shape.offset().top;
  var windowHeight = $(window).height();
  var shapeDistanceFromTop = shapeOffset - scroll;
  var maxOffset = shapeDistanceFromTop;
  var maxDistance = $("body").height() - windowHeight;
  var distanceScrolled = scroll / maxDistance;
  var translateY = -distanceScrolled * maxOffset;

  shape.css("transform", "translate(0%, " + translateY + "px)");
});

/*-------------------------
  Testimonial Swiper JS
-------------------------*/

const swsiper = new Swiper('.mySwiper', {
  // Optional parameters 
  loop: true,
  // If we need pagination
  pagination: {
    el: '.swiper-pagination',
    clickable: true
  },
  breakpoints: {
    0: {
      slidesPerView: 1,
      spaceBetween: 10,

    },
    768: {
      slidesPerView: 2,
      spaceBetween: 30,
    }
  }
});

/*-------------------------
    POST SIDEBAR TOGGLER
-------------------------*/
function postSidebar() {
  $(".post-sidebar-toggle").on("click", function () {
    $(this).toggleClass("open");
    $(".post-sidebar").toggleClass("open");
  });
}
